<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="refresh" content="5; URL=STC.html">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ØªØ®Ø·ÙŠ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø³Ø±Ø¹Ø© Ù„Ù€ STC</title>
    <style>
        /* Improved CSS with dark mode and animations */
        :root {
            --primary-color: #34005f;
            --primary-light: #5c2a8a;
            --success-color: #28a745;
            --danger-color: #dc3545;
            --bg-light: #718eac;
            --bg-dark: #343a40;
            --text-light: #ffffff;
            --text-dark: #212529;
            --container-bg: #1e0729;
            --border-radius: 10px;
            --transition: all 0.3s ease;
            --text-color: #ffffff;
        }

        body {
            font-family: 'Tajawal', sans-serif;
            background-color: var(--bg-light);
            color: var(--text-dark);
            padding: 20px;
            transition: background-color 0.3s, color 0.3s;
        }

        .provider-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2.5rem;
        }

        .provider-card {
            background: var(--container-bg);
            border: 1px solid rgba(106, 27, 154, 0.2);
            border-radius: var(--border-radius);
            overflow: hidden;
            transition: var(--transition);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .provider-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px rgba(106, 27, 154, 0.2);
            border-color: var(--primary-light);
        }

        .provider-card a {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 1.5rem 1rem;
            color: var(--text-color);
            text-decoration: none;
            height: 100%;
        }

        .provider-card .icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            color: var(--primary-color);
            transition: var(--transition);
        }

        .provider-card:hover .icon {
            transform: scale(1.2);
            color: var(--primary-light);
        }

        .provider-card .name {
            font-weight: 700;
            font-size: 1.2rem;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: #1e0729;
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0,0,0,0.1);
            color: var(--text-light);
        }

        .progress-bar {
            height: 8px;
            background: #396692;
            border-radius: 4px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-fill {
            height: 100%;
            background: var(--primary-color);
            width: 0%;
            transition: width 0.3s;
        }

        .status {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1rem;
        }

        .server-status {
            margin: 1rem 0;
            padding: 10px;
            border-radius: 5px;
        }

        .server-status.success {
            background-color: var(--success-color);
            color: white;
        }

        .server-status.danger {
            background-color: var(--danger-color);
            color: white;
        }

        .text-center {
            text-align: center;
        }

        .mb-4 {
            margin-bottom: 1.5rem;
        }

        .mt-4 {
            margin-top: 1.5rem;
        }

        .btn {
            display: inline-block;
            font-weight: 400;
            text-align: center;
            white-space: nowrap;
            vertical-align: middle;
            user-select: none;
            border: 1px solid transparent;
            padding: 0.375rem 0.75rem;
            font-size: 1rem;
            line-height: 1.5;
            border-radius: 0.25rem;
            transition: color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
            cursor: pointer;
        }

        .btn-primary {
            color: #fff;
            background-color: var(--primary-color);
            border-color: var(--primary-color);
        }

        .btn-primary:hover {
            background-color: var(--primary-light);
            border-color: var(--primary-light);
        }

        .list-group {
            display: flex;
            flex-direction: column;
            padding-left: 0;
            margin-bottom: 0;
            list-style: none;
        }

        .list-group-item {
            position: relative;
            display: block;
            padding: 0.75rem 1.25rem;
            margin-bottom: -1px;
            background-color: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--text-light);
            border-radius: 5px;
            margin-bottom: 5px;
        }

        .links {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .links a {
            display: inline-block;
            padding: 0.75rem 1.5rem;
            background-color: var(--primary-color);
            color: white;
            text-decoration: none;
            border-radius: 5px;
            transition: background-color 0.3s;
            font-weight: 600;
        }

        .links a:hover {
            background-color: var(--primary-light);
            transform: translateY(-3px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .telegram-link {
            display: block;
            text-align: center;
            margin: 1.5rem auto;
            color: var(--text-light);
            text-decoration: none;
            font-weight: 700;
            font-size: 1.2rem;
        }

        .telegram-link i {
            margin-left: 0.5rem;
            color: #0088cc;
        }

        @media (prefers-color-scheme: dark) {
            body {
                --bg-light: #343a40;
                --text-dark: #ffffff;
                --primary-color: #4a0075;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="text-center mb-4">
            <i class="fas fa-tachometer-alt"></i> ØªØ®Ø·ÙŠ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø³Ø±Ø¹Ø© Ù„Ù€ STC
        </h1>
        <div class="links">
            <a href="STC.html">ØªØ®Ø·ÙŠ STC</a>
            <a href="MOBILY.html">ØªØ®Ø·ÙŠ Mobily</a>
            <a href="ZAIN.html">ØªØ®Ø·ÙŠ Zain</a>
            <a href="ITC.html">ØªØ®Ø·ÙŠ ITC</a>
            <a href="GO.html">ØªØ®Ø·ÙŠ GO</a>
        </div>
        <a href="https://t.me/jljal/" class="telegram-link">
            <i class="fab fa-telegram"></i> Ù„Ù„ØªÙˆØ§ØµÙ„ğŸ“²
        </a>

        <div class="status">
            <div id="connection-status">Ø¬Ø§Ø±Ù Ø§Ù„Ø§ØªØµØ§Ù„...</div>
            <div id="refresh-timer">Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¨Ø¹Ø¯ <span id="countdown">5</span> Ø«ÙˆØ§Ù†</div>
        </div>

        <div class="progress-bar">
            <div class="progress-fill" id="progress"></div>
        </div>

        <div class="server-status" id="server-status">
            Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø®ÙˆØ§Ø¯Ù…...
        </div>

        <div class="text-center mt-4">
            <button class="btn btn-primary" onclick="toggleTheme()">
                <i class="fas fa-adjust"></i> ØªØºÙŠÙŠØ± Ø§Ù„Ø«ÙŠÙ…
            </button>
        </div>

        <div class="mt-4">
            <h3>Ø§Ù„Ø®ÙˆØ§Ø¯Ù… Ø§Ù„Ù†Ø´Ø·Ø©:</h3>
            <ul id="active-servers" class="list-group"></ul>
        </div>
    </div>

    <script>
        // Configuration
        const SERVERS = {
            stc: [
                "https://speedtest.saudi.net.sa:8080/speedtest/upload.php",
                "https://dam-speedtest.saudi.net.sa:8080/speedtest/upload.php",
                "https://jed-speedtest.saudi.net.sa:8080/speedtest/upload.php",
                "https://riy-speedtest.saudi.net:8080/speedtest/upload.php",
                "https://med-speedtest.saudi.net.sa:8080/speedtest/upload.php"
            ],
            mobily: [
                // Add Mobily servers here
            ],
            zain: [
                // Add Zain servers here
            ]
        };

        // State variables
        let currentTheme = 'light';
        let activeServers = [];
        let refreshInterval;

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            startProgress();
            checkServers();
            updateCountdown();
            registerServiceWorker();
        });

        // Service Worker Registration
        function registerServiceWorker() {
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('/sw.js')
                    .then(reg => console.log('Service Worker Registered'))
                    .catch(err => console.log('Service Worker Failed:', err));
            }
        }

        // Server checking with retries
        async function checkServers() {
            const serverList = SERVERS.stc; // Change based on ISP detection
            const results = await Promise.allSettled(
                serverList.map(server => 
                    fetch(server, { method: 'HEAD', mode: 'no-cors' })
                        .then(() => ({ server, status: 'success' }))
                        .catch(() => ({ server, status: 'failed' }))
                )
            );

            activeServers = results
                .filter(r => r.status === 'fulfilled' && r.value.status === 'success')
                .map(r => r.value.server);

            updateServerList();
        }

        // Update server display
        function updateServerList() {
            const list = document.getElementById('active-servers');
            list.innerHTML = activeServers.map(server => 
                `<li class="list-group-item">${server}</li>`
            ).join('');

            const statusEl = document.getElementById('server-status');
            if (activeServers.length > 0) {
                statusEl.className = 'server-status success';
                statusEl.textContent = `ØªÙ… ØªÙØ¹ÙŠÙ„ ${activeServers.length} Ø®ÙˆØ§Ø¯Ù…`;
            } else {
                statusEl.className = 'server-status danger';
                statusEl.textContent = 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø®ÙˆØ§Ø¯Ù… Ù†Ø´Ø·Ø©';
            }
        }

        // Progress bar animation
        function startProgress() {
            const progress = document.getElementById('progress');
            let width = 0;
            const interval = setInterval(() => {
                if (width >= 100) clearInterval(interval);
                width += 2;
                progress.style.width = width + '%';
            }, 100);
        }

        // Countdown timer
        function updateCountdown() {
            let timeLeft = 5;
            const countdown = document.getElementById('countdown');
            refreshInterval = setInterval(() => {
                timeLeft--;
                countdown.textContent = timeLeft;
                if (timeLeft <= 0) {
                    clearInterval(refreshInterval);
                    window.location.reload();
                }
            }, 1000);
        }

        // Theme toggle
        function toggleTheme() {
            currentTheme = currentTheme === 'light' ? 'dark' : 'light';
            document.body.style.backgroundColor = 
                currentTheme === 'light' ? '#f8f9fa' : '#343a40';
            document.body.style.color = 
                currentTheme === 'light' ? '#212529' : '#ffffff';
        }

        // Periodic server pings
        setInterval(() => {
            if (activeServers.length === 0) return;
            const server = activeServers[Math.floor(Math.random() * activeServers.length)];
            fetch(server, { 
                method: 'HEAD', 
                mode: 'no-cors',
                headers: { 'User-Agent': getRandomUserAgent() }
            });
        }, Math.random() * 5000 + 3000); // 3-8s random interval

        // User agent rotation
        function getRandomUserAgent() {
            const agents = [
                "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",
                "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.0 Safari/605.1.15",
                "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36"
            ];
            return agents[Math.floor(Math.random() * agents.length)];
        }
    </script>
    <script>
        // Service Worker script (sw.js)
        self.addEventListener('install', event => {
            self.skipWaiting();
        });

        self.addEventListener('activate', event => {
            clients.claim();
        });

        self.addEventListener('fetch', event => {
            if (event.request.url.includes('speedtest')) {
                event.respondWith(
                    fetch(event.request)
                        .catch(() => new Response('Service Unavailable', { status: 503 }))
                );
            }
        });
    </script>
</body>
</html>
